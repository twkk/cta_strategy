日內交易模型的設計思路

【入市設計】
系統模型入市的設計思路，事實上應與投資者的交易風格喜好、交易時間框架密切相關，可以分別是趨勢跟踪、震盪交易、套利交易等，近年來甚至也出現了基於基本面分析數據的量化模型，以及帶有人工智能性質的神經網絡、遺傳算法等具備自學習、自適應市場能力的高級交易系統模型。不過，最簡單、最實用、最適合普通投資者的交易系統入市設計思路仍然是趨勢跟踪，而趨勢跟踪的實質就是追漲殺跌或者美其名曰：順勢而為。突破，是趨勢跟踪系統設計中最為簡潔實用的設計思路，具體應用設計思路可能包括：

⒈通道突破。最著名的此類程式設計代表作為：海龜交易法則與四周規則。其入市信號觸發設計為：價格突破最近N根K線的高低點。長期來看，這種設計思路雖然簡單，但永遠也不會失效或顯得過時。事實上，越簡單的反而越有效。

⒉ 均線突破。該設計思路的代表作品有：克羅均線，它由4、9、18等三條均線組成；鱷魚組線，它由5、8、13等三條移中平均線組成；自適應均線，它由考夫曼博士提出，以市場效率生成彈性浮動參數，以均線拐頭為信號觸發。

⒊ 指標突破。常見的技術分析指標，如MACD、KDJ、RSI、BOLL、SAR、WR、ADX等，均可獨立構成一個簡單的趨勢跟踪系統，當然，是使用系統默認參數，還是使用優化參數；是使用其常規用法，還是使用創新用法，可能存在仁者見仁、智者見智的分歧。

⒋ 形態突破。形態突破，包括K線形態組合突破、經典技術分析形態突破等，K線形態組合的突破，以酒田戰法為最經典，著名的紅三兵、黑三兵、希望之星等經典K 線形態均源於此，共分為酒田戰法70型。至於經典的雙頂、雙底、趨勢線突破、橫盤突破、頭肩頂底、三角形態、楔形、旗形、鑽石型、圓弧頂底等技術形態，因普通的模型編寫語言較難精確描述而存在一定的設計使用障礙，需要使用轉向函數及圖形模糊識別技術來克服。

⒌ 波動性突破。波動性可以定義為：最高價與最低價、當根K線的最高價與昨收盤、當根K線的最低價與昨收盤，這三組價格差額的最大者即該品種的波動性值，波動性既可以進行橫向比較品種間的波動性水平，也可以用於縱向判斷價格波動的異常，並作為入市信號的觸發器。

⒍ 時間價格突破。在趨勢行情的必經之路，守株待兔，是我們進行突破系統設計的基本思路。而時間、價格突破，從速度、幅度的兩維視角預約了趨勢行情，堪稱突破系統設計的典範。基本設計思路為價格在N時間範圍內、上漲或下跌了N個點位。進一步拓展思路後，還可以引入周間日、日間時的概念，細化不同時間段的突破標準，以便更好地適應品種個性，此外，還可以時間、價格過濾器的方法來實現對趨勢行情的確認，以減少價格盤整階段的假突破現象。

【離市設計】
⒈ 止損。止損，是交易系統模型設計中一個不可或缺的元素，資金止損、技術止損，是兩種主要的考慮方案，採用兩者孰低的方案可能更為科學。一方面，你要確保每筆交易不冒過大的風險，另一方面，你要背靠一個關鍵的壓力、支撐技術位置，採用反向交易信號作為自動止損的依據，則是持續在市的交易系統模型的一個常用止損方法。

⒉止盈。雖然固定點位的止盈、止損，也是系統設計中可以採用的方法，但我們更傾向於兼顧利潤保護和放大功能的跟踪止盈或SAR拋物線止盈模式，隨著利潤的擴大，而不斷抬高甚至收緊止盈目標位置，可以在一定程度上起到利潤最大化的設計目標。

⒊ 時間清倉。以時間為因素考慮離場，無論是作為一種輔助離場方法，還是作為一種獨立的出市方法，都是一個不錯的思路。比如三根K線過後，如果既沒有達到止盈位、也沒有觸及止損位，就主動離場。

績效指標的迷失

1、總獲利金額(Net Profit) 
有沒有合理考慮成本？從每筆交易紀錄中，推算成本金額，是否合理包含交易稅，手續費與滑價損失。另外，換約必然產生的成本，有無考慮？

有沒有考慮合理執行達標率？訊號產生到實際交易執行成功，之間的滑價，是否合理估計，這包含交易執行的準備時間充不充分，交易單的方式合不合理？

多久的交易期間？系統總是有表現好的時後，與表現不好的時候。如果交易期間太短（低於５年），可能只是把表現比較好的一面呈現出來，不具整體代表性。

多大的風險代價？如果最大的連續虧損過大（占之前淨值高點比例過大），這樣的獲利報酬的代價是不是可以被接受，如果無法接受，那這樣的報酬是無法真正實現的。因為在持續虧損下，早就放棄執行這樣的系統，或者，獲利之後，又容易回吐殆盡。

2、報酬率：
報酬率期間長度（用多少時間來計算報酬率的分子：盈虧金額）。是年報酬率？還是月報酬率？時間長短不同，累積的報酬率自然不同。

取樣的期間長度（總交易期間）。是單年的報酬率？還是多年的平均報酬率？與多久的交易期間觀念相同。

報酬率的基準金額為何（報酬率分母）。起始賬戶資金為何？資金管理模式為何？有一種報酬率，稱為最小賬戶資金報酬率（ROA）。是用過去最大連續虧損金額（MDD），加上原始保證金來當報酬率的分母。這是最大風險下的報酬率。

多大的風險代價？若以ROA代表報酬率，是必須承受將近百分百的賬戶虧損風險，才能得到這樣的報酬率，並不切實際。每個人的風險承受能力不同，但100%的風險承受並不是正常合理的假設。單口系統不易表現出合理的風險報酬率，但可以約略從淨值曲線與一些風險報酬進階指標看出。適當的資金管理多口數係統，可以合理表現報酬率。

3、交易頻率：
頻率太低，交易次數少，不具代表性。取樣期間內應該超過３６筆交易。

頻率太高，交易次數多，執行的精神成本過高。因人而異，每日不超過３筆交易為宜。

4、實際績效與模擬績效：
模擬績效
一般系統績效多是以歷史數據來仿真的，必須了解系統仿真的原理與假設。因為Ｋ線資料只有４個統計值（開盤價/ 最高價/ 最低價/ 收盤價），所以，必須有所謂的Ｋ線假設（Bar Assumptions），來模擬行情在Ｋ線中的走勢，當Ｋ線的時間架構越大（如日線，週線）時，誤差就會越大。在TradeStation中，即使時間架構是日線，仍然可以用分線，甚至是實際每筆交易紀錄，這種用更細微的時間單位（Resolution），來仿真過去交易與績效，誤差就大為減少了。當然，前提是歷史的數據必須是存在與正確的。

有些仿真程序與TradeStation一樣，都有所謂的收盤進場訊號，這本來在實際執行交易上，邏輯是行不通的。之前，最後一盤為5分鐘集中撮合，可以在這5分鐘內，以市價單來進出場，可以讓收盤進場的訊號適用，現在期交所已經取消最後５分鐘的集中撮合。另外，有些程序系統參考收盤價，來決定是否收盤進出場，這在仿真程序可以做到，但在實務上，卻是無法執行的，也造成了模擬績效的誤謬。

實際績效
有些人會把實際賬戶的交易績效，以交易報告書公佈出來。除非是長時間的詳細交易紀錄，否則，都無法證實是系統完全執行下的結果。

有的系統績效時好時壞，若只能比對短時間，系統與實際賬戶的績效，比較難證明系統與實際賬戶的一致性。

如果只是公佈賬戶資金的變動，而沒有實際的交易紀錄，報酬率也可能是虛胖的。比如，股指多手數係統，可以設定10%的總資金風險，來控制交易手數。這時，只要把10%~20%的資金放在保證金賬戶就可以了，單以保證金賬戶來看，報酬率與實際總資金報酬率，多了5到10倍。

作者：量化投資Quant
链接：https://xueqiu.com/5256769224/32429363
来源：雪球
